
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as K}from"./index-eb967e6b.js";import{a8 as b,d as Q,r as I,R as Z,x as ee,o as f,c as k,e as t,f as l,N as V,S as q,b as _,k as u,a as C,w as te,I as A,t as m,E as N,h as o,X as le,q as P}from"./index-614bd441.js";import{A as $}from"./chat-bd579b34.js";import{u as ae}from"./utcformatTime-e76e5157.js";import{d as oe,W as ne,e as re}from"./index-49b2e49a.js";const se={queryAdminDrawList:s=>b.get("midjourney/adminDrawList",{params:s}),salesAuditOrder:s=>b.post("sales/auditOrder",s),updateSalesUser:s=>b.post("sales/updateUserSales",s),queryRecords:s=>b.get("sales/inviteRecords",{params:s}),querySalesUserList:s=>b.get("sales/salesUserList",{params:s})},ie={style:{float:"right"}},ce={class:"answer"},ue={class:"answer_container"},de=["src"],pe=Q({__name:"draw",setup(s){const z=I(),U=I(0),v=I(!1),i=Z({rec:null,status:null,page:1,size:10}),x=I([]);async function d(){try{v.value=!0;const r=await se.queryAdminDrawList(i);v.value=!1;const{rows:a,count:y}=r.data;U.value=y,x.value=a}catch{v.value=!1}}function j(r){r==null||r.resetFields(),d()}async function O(r){const a=await $.recMjDrawImg({id:r});N.success(a.data),d()}async function B(r){const a=await $.delChatLog({id:r});N.success(a.data),d()}return ee(()=>{d()}),(r,a)=>{const y=o("el-option"),T=o("el-select"),D=o("el-form-item"),g=o("el-button"),W=o("el-form"),S=K,Y=o("el-alert"),n=o("el-table-column"),F=o("el-image"),M=o("el-tag"),E=o("el-popover"),L=o("el-popconfirm"),H=o("el-table"),J=o("el-pagination"),X=o("el-row"),G=le("loading");return f(),k("div",null,[t(S,null,{default:l(()=>[t(W,{ref_key:"formRef",ref:z,inline:!0,model:i},{default:l(()=>[t(D,{label:"推荐状态",prop:"rec"},{default:l(()=>[t(T,{modelValue:i.rec,"onUpdate:modelValue":a[0]||(a[0]=e=>i.rec=e),placeholder:"请选择推荐状态",clearable:""},{default:l(()=>[(f(!0),k(V,null,q(_(oe),e=>(f(),A(y,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(D,{label:"绘制状态",prop:"status"},{default:l(()=>[t(T,{modelValue:i.status,"onUpdate:modelValue":a[1]||(a[1]=e=>i.status=e),placeholder:"请选择绘制状态",clearable:""},{default:l(()=>[(f(!0),k(V,null,q(_(ne),e=>(f(),A(y,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(D,null,{default:l(()=>[t(g,{type:"primary",onClick:d},{default:l(()=>[u(" 查询 ")]),_:1}),t(g,{onClick:a[2]||(a[2]=e=>j(_(z)))},{default:l(()=>[u(" 重置 ")]),_:1})]),_:1}),C("span",ie,[t(g,{type:"success",onClick:d},{default:l(()=>[u(" 刷新列表 ")]),_:1})])]),_:1},8,["model"])]),_:1}),t(S,null,{default:l(()=>[t(Y,{"show-icon":"",title:"MJ绘图历史说明",description:"点击推荐的图片将会出现在画廊当中！",type:"success"})]),_:1}),t(S,{style:{width:"100%"}},{default:l(()=>[te((f(),A(H,{border:"",data:_(x),style:{width:"100%"},size:"large"},{default:l(()=>[t(n,{prop:"id",align:"center",label:"ID",width:"70"}),t(n,{prop:"fileInfo.thumbImg",align:"center",label:"绘图结果"},{default:l(e=>{var c,p,w,h;return[t(F,{style:{height:"120px"},"preview-teleported":"",fit:"contain","preview-src-list":[(p=(c=e.row)==null?void 0:c.fileInfo)==null?void 0:p.cosUrl],src:(h=(w=e.row)==null?void 0:w.fileInfo)==null?void 0:h.thumbImg,lazy:"","hide-on-click-modal":""},null,8,["preview-src-list","src"])]}),_:1}),t(n,{prop:"userInfo.username",align:"center",label:"用户名",width:"120"}),t(n,{prop:"fileInfo.thumbImg",align:"center",label:"推荐状态",width:"90"},{default:l(e=>[t(M,{type:e.row.rec===1?"success":""},{default:l(()=>[u(m(e.row.rec===1?"已推荐":"未推荐"),1)]),_:2},1032,["type"])]),_:1}),t(n,{prop:"userInfo.email",label:"邮箱",width:"180",align:"center"}),t(n,{prop:"status",align:"center",label:"绘图状态",width:"105"},{default:l(e=>[t(M,{type:e.row.status===100?"success":""},{default:l(()=>[u(m(_(re)[e.row.status]),1)]),_:2},1032,["type"])]),_:1}),t(n,{prop:"fullPrompt",label:"绘图指令",align:"center",width:"200"},{default:l(e=>[t(E,{placement:"top",width:400,trigger:"click"},{reference:l(()=>[C("div",ce,m(e.row.fullPrompt),1)]),default:l(()=>[C("div",ue,m(e.row.fullPrompt),1)]),_:2},1024)]),_:1}),t(n,{prop:"progress",align:"center",label:"绘图进度",width:"90"}),t(n,{prop:"fileInfo.thumbImg",align:"center",label:"绘图尺寸",width:"120"},{default:l(e=>{var c,p,w,h,R;return[u(m((c=e.row)!=null&&c.fileInfo?`${(w=(p=e.row)==null?void 0:p.fileInfo)==null?void 0:w.width}*${(R=(h=e.row)==null?void 0:h.fileInfo)==null?void 0:R.height}`:"---"),1)]}),_:1}),t(n,{prop:"userInfo.avatar",label:"用户头像",width:"90"},{default:l(e=>{var c,p;return[C("img",{src:(p=(c=e.row)==null?void 0:c.userInfo)==null?void 0:p.avatar,style:{height:"50px"}},null,8,de)]}),_:1}),t(n,{prop:"createdAt",label:"提问时间",align:"center",width:"200"},{default:l(e=>[u(m(_(ae)(e.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)]),_:1}),t(n,{fixed:"right",label:"操作",width:"200",align:"center"},{default:l(e=>[t(L,{title:`确认${e.row.rec===1?"取消推荐":"推荐"}图片吗！`,width:"260","icon-color":"red",onConfirm:c=>O(e.row.id)},{reference:l(()=>[t(g,{link:"",type:e.row.rec===1?"success":"",size:"small"},{default:l(()=>[u(" 推荐图片 ")]),_:2},1032,["type"])]),_:2},1032,["title","onConfirm"]),t(L,{title:"`确认删除此条记录么！",width:"260","icon-color":"red",onConfirm:c=>B(e.row.id)},{reference:l(()=>[t(g,{type:"warning",size:"small"},{default:l(()=>[u(" 删除记录 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[G,_(v)]]),t(X,{class:"flex justify-end mt-5"},{default:l(()=>[t(J,{"current-page":i.page,"onUpdate:currentPage":a[3]||(a[3]=e=>i.page=e),"page-size":i.size,"onUpdate:pageSize":a[4]||(a[4]=e=>i.size=e),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:_(U),onSizeChange:d,onCurrentChange:d},null,8,["current-page","page-size","total"])]),_:1})]),_:1})])}}});typeof P=="function"&&P(pe);export{pe as default};
