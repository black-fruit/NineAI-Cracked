'use strict';const _0x2210de=_0x318d;(function(_0x5bff5d,_0x2b4aa0){const _0xa5b48e=_0x318d,_0x221231=_0x5bff5d();while(!![]){try{const _0xd76774=parseInt(_0xa5b48e(0xc7))/0x1*(parseInt(_0xa5b48e(0xdd))/0x2)+parseInt(_0xa5b48e(0xde))/0x3+-parseInt(_0xa5b48e(0xef))/0x4+-parseInt(_0xa5b48e(0xd8))/0x5+-parseInt(_0xa5b48e(0xf9))/0x6+parseInt(_0xa5b48e(0xe8))/0x7+parseInt(_0xa5b48e(0xe9))/0x8;if(_0xd76774===_0x2b4aa0)break;else _0x221231['push'](_0x221231['shift']());}catch(_0x5cdd9b){_0x221231['push'](_0x221231['shift']());}}}(_0x4ebe,0xa9f91));var __decorate=this&&this[_0x2210de(0xe5)]||function(_0x27d338,_0x2ac99d,_0xe6be61,_0x2e515d){const _0x25ccc0=_0x2210de;var _0x5cd0e3=arguments[_0x25ccc0(0xe1)],_0x2b3362=_0x5cd0e3<0x3?_0x2ac99d:_0x2e515d===null?_0x2e515d=Object['getOwnPropertyDescriptor'](_0x2ac99d,_0xe6be61):_0x2e515d,_0x1dc339;if(typeof Reflect===_0x25ccc0(0xf6)&&typeof Reflect[_0x25ccc0(0xeb)]==='function')_0x2b3362=Reflect[_0x25ccc0(0xeb)](_0x27d338,_0x2ac99d,_0xe6be61,_0x2e515d);else{for(var _0x599305=_0x27d338[_0x25ccc0(0xe1)]-0x1;_0x599305>=0x0;_0x599305--)if(_0x1dc339=_0x27d338[_0x599305])_0x2b3362=(_0x5cd0e3<0x3?_0x1dc339(_0x2b3362):_0x5cd0e3>0x3?_0x1dc339(_0x2ac99d,_0xe6be61,_0x2b3362):_0x1dc339(_0x2ac99d,_0xe6be61))||_0x2b3362;}return _0x5cd0e3>0x3&&_0x2b3362&&Object[_0x25ccc0(0xcf)](_0x2ac99d,_0xe6be61,_0x2b3362),_0x2b3362;},__metadata=this&&this['__metadata']||function(_0x392be3,_0x2ad256){const _0xd85fe4=_0x2210de;if(typeof Reflect===_0xd85fe4(0xf6)&&typeof Reflect['metadata']===_0xd85fe4(0xf7))return Reflect[_0xd85fe4(0xdc)](_0x392be3,_0x2ad256);},__param=this&&this[_0x2210de(0xf1)]||function(_0x2c6c76,_0x327efb){return function(_0x5d73a9,_0x3836c2){_0x327efb(_0x5d73a9,_0x3836c2,_0x2c6c76);};};function _0x318d(_0x593461,_0x13d2f2){const _0x4ebefb=_0x4ebe();return _0x318d=function(_0x318db9,_0x4e5a71){_0x318db9=_0x318db9-0xc7;let _0x6b2fe4=_0x4ebefb[_0x318db9];return _0x6b2fe4;},_0x318d(_0x593461,_0x13d2f2);}Object['defineProperty'](exports,_0x2210de(0xe2),{'value':!![]}),exports['ChatGroupService']=void 0x0;const common_1=require('@nestjs/common'),chatGroup_entity_1=require('./chatGroup.entity'),typeorm_1=require(_0x2210de(0xe0)),typeorm_2=require(_0x2210de(0xf4)),app_entity_1=require(_0x2210de(0xf2));let ChatGroupService=class ChatGroupService{constructor(_0x5110b4,_0x182606){const _0x48e2d2=_0x2210de;this[_0x48e2d2(0xee)]=_0x5110b4,this['appEntity']=_0x182606;}async[_0x2210de(0xea)](_0x48df37,_0x4d1e95){const _0x4bad78=_0x2210de,{id:_0x416bb7}=_0x4d1e95[_0x4bad78(0xd0)],{appId:_0x37411c}=_0x48df37,_0x10bfdd={'title':_0x4bad78(0xf8),'userId':_0x416bb7};if(_0x37411c){const _0x386e7c=await this[_0x4bad78(0xd2)][_0x4bad78(0xe6)]({'where':{'id':_0x37411c}});if(!_0x386e7c)throw new common_1['HttpException']('非法操作、您在使用一个不存在的应用！',common_1[_0x4bad78(0xc8)]['BAD_REQUEST']);else{const {status:_0x2fc12b,name:_0x59803a}=_0x386e7c,_0x190759=await this[_0x4bad78(0xee)][_0x4bad78(0xd4)]({'where':{'userId':_0x416bb7,'appId':_0x37411c,'isDelete':![]}});if(_0x190759>0x0)throw new common_1[(_0x4bad78(0xf0))]('当前应用已经开启了一个对话无需新建了！',common_1[_0x4bad78(0xc8)]['BAD_REQUEST']);if(![0x1,0x3,0x4,0x5][_0x4bad78(0xd1)](_0x2fc12b))throw new common_1[(_0x4bad78(0xf0))](_0x4bad78(0xc9),common_1['HttpStatus'][_0x4bad78(0xcc)]);_0x59803a&&(_0x10bfdd[_0x4bad78(0xe7)]=_0x59803a),_0x37411c&&(_0x10bfdd['appId']=_0x37411c);}}return await this[_0x4bad78(0xee)][_0x4bad78(0xda)](_0x10bfdd);}async[_0x2210de(0xcd)](_0x5b2b3d){const _0x5d6367=_0x2210de,{id:_0x54680e}=_0x5b2b3d[_0x5d6367(0xd0)],_0x57a1f7={'userId':_0x54680e,'isDelete':![]};return await this[_0x5d6367(0xee)][_0x5d6367(0xce)]({'where':_0x57a1f7,'order':{'isSticky':_0x5d6367(0xf3),'id':_0x5d6367(0xf3)}});}async[_0x2210de(0xed)](_0x2e63be,_0x194d2c){const _0x1af3dd=_0x2210de,{title:_0x58dd0c,isSticky:_0x262c24,groupId:_0x2f66b3}=_0x2e63be,{id:_0x129daf}=_0x194d2c[_0x1af3dd(0xd0)],_0x55fe57=await this[_0x1af3dd(0xee)][_0x1af3dd(0xe6)]({'where':{'id':_0x2f66b3,'userId':_0x129daf}});if(!_0x55fe57)throw new common_1[(_0x1af3dd(0xf0))]('非法操作、您在修改一个非法资源！',common_1[_0x1af3dd(0xc8)][_0x1af3dd(0xcc)]);const {appId:_0x1c9681}=_0x55fe57;if(_0x1c9681)throw new common_1[(_0x1af3dd(0xf0))](_0x1af3dd(0xd3),common_1[_0x1af3dd(0xc8)][_0x1af3dd(0xcc)]);const _0x1d0cb3={};_0x58dd0c&&(_0x1d0cb3[_0x1af3dd(0xe7)]=_0x58dd0c),typeof _0x262c24!=='undefined'&&(_0x1d0cb3[_0x1af3dd(0xe3)]=_0x262c24);const _0x299c79=await this[_0x1af3dd(0xee)]['update']({'id':_0x2f66b3},_0x1d0cb3);if(_0x299c79['affected'])return!![];else throw new common_1[(_0x1af3dd(0xf0))](_0x1af3dd(0xdf),common_1[_0x1af3dd(0xc8)][_0x1af3dd(0xcc)]);}async[_0x2210de(0xfa)](_0xf0dea4,_0x149cf5){const _0x1d9ff3=_0x2210de,{groupId:_0x14da01}=_0xf0dea4,{id:_0x109177}=_0x149cf5['user'],_0xaf92e4=await this[_0x1d9ff3(0xee)]['findOne']({'where':{'id':_0x14da01,'userId':_0x109177}});if(!_0xaf92e4)throw new common_1[(_0x1d9ff3(0xf0))](_0x1d9ff3(0xdb),common_1[_0x1d9ff3(0xc8)][_0x1d9ff3(0xcc)]);const _0x2a0b78=await this[_0x1d9ff3(0xee)][_0x1d9ff3(0xed)]({'id':_0x14da01},{'isDelete':!![]});if(_0x2a0b78['affected'])return _0x1d9ff3(0xd7);else throw new common_1[(_0x1d9ff3(0xf0))](_0x1d9ff3(0xf5),common_1['HttpStatus'][_0x1d9ff3(0xcc)]);}async[_0x2210de(0xca)](_0x471ff4){const _0x397d92=_0x2210de,{id:_0x4c452d}=_0x471ff4[_0x397d92(0xd0)],_0x1b1d70=await this['chatGroupEntity'][_0x397d92(0xed)]({'userId':_0x4c452d,'isSticky':![],'isDelete':![]},{'isDelete':!![]});if(_0x1b1d70[_0x397d92(0xd6)])return _0x397d92(0xd7);else throw new common_1['HttpException'](_0x397d92(0xf5),common_1['HttpStatus']['BAD_REQUEST']);}};function _0x4ebe(){const _0x174cac=['update','chatGroupEntity','3312104HICaOO','HttpException','__param','../app/app.entity','DESC','typeorm','删除失败！','object','function','新对话','7387776smKSzh','del','421768ozsbZR','HttpStatus','非法操作、您在使用一个未启用的应用！','delAll','ChatGroupEntity','BAD_REQUEST','query','find','defineProperty','user','includes','appEntity','应用对话名称不能修改哟！','count','Repository','affected','删除成功','2515405kQFnNc','design:paramtypes','save','非法操作、您在删除一个非法资源！','metadata','2ZdPMFM','2871012uATyve','更新对话失败！','@nestjs/typeorm','length','__esModule','isSticky','Injectable','__decorate','findOne','title','200501ECreUO','14809576OQUgla','create','decorate','InjectRepository'];_0x4ebe=function(){return _0x174cac;};return _0x4ebe();}ChatGroupService=__decorate([(0x0,common_1[_0x2210de(0xe4)])(),__param(0x0,(0x0,typeorm_1[_0x2210de(0xec)])(chatGroup_entity_1[_0x2210de(0xcb)])),__param(0x1,(0x0,typeorm_1[_0x2210de(0xec)])(app_entity_1['AppEntity'])),__metadata(_0x2210de(0xd9),[typeorm_2[_0x2210de(0xd5)],typeorm_2[_0x2210de(0xd5)]])],ChatGroupService),exports['ChatGroupService']=ChatGroupService;