'use strict';const _0x4b94d4=_0x2714;(function(_0x210696,_0x52b766){const _0x1af447=_0x2714,_0x209590=_0x210696();while(!![]){try{const _0x34589e=parseInt(_0x1af447(0xf5))/0x1*(-parseInt(_0x1af447(0xff))/0x2)+-parseInt(_0x1af447(0xe3))/0x3+parseInt(_0x1af447(0xee))/0x4+parseInt(_0x1af447(0xdf))/0x5+-parseInt(_0x1af447(0xe2))/0x6*(-parseInt(_0x1af447(0xea))/0x7)+-parseInt(_0x1af447(0xe7))/0x8+-parseInt(_0x1af447(0xf0))/0x9;if(_0x34589e===_0x52b766)break;else _0x209590['push'](_0x209590['shift']());}catch(_0x494ae8){_0x209590['push'](_0x209590['shift']());}}}(_0x4220,0x2a3b9));function _0x4220(){const _0x33bb54=['会员已到期、清空所有余额并移除会员身份！','length','GlobalConfigService','defineProperty','InjectRepository','then','checkUserMemerExpire','decorate','forEach','636180gDoutq','check\x20nineai\x20auth','object','1218AbRoTu','31323iLNKUH','Cron','typeorm','design:type','764784fTPnDS','LessThanOrEqual','find','9569zwNNKE','Logger','getOwnPropertyDescriptor','update','1272192nCQmJn','design:returntype','3015999UJkzAL','@nestjs/schedule','CronExpression','userBalanceEntity','design:paramtypes','10XFbOly','TaskService','debug','globalConfigService','function','metadata','@nestjs/typeorm','Repository','checkauth','Injectable','21730TAwAgI','handleCron','prototype'];_0x4220=function(){return _0x33bb54;};return _0x4220();}var __decorate=this&&this['__decorate']||function(_0x1dec8c,_0x54321f,_0x3f1592,_0x468362){const _0x47d7cb=_0x2714;var _0x2fb656=arguments[_0x47d7cb(0xd7)],_0x5ca783=_0x2fb656<0x3?_0x54321f:_0x468362===null?_0x468362=Object[_0x47d7cb(0xec)](_0x54321f,_0x3f1592):_0x468362,_0x5efc41;if(typeof Reflect===_0x47d7cb(0xe1)&&typeof Reflect[_0x47d7cb(0xdd)]===_0x47d7cb(0xf9))_0x5ca783=Reflect[_0x47d7cb(0xdd)](_0x1dec8c,_0x54321f,_0x3f1592,_0x468362);else{for(var _0x179a32=_0x1dec8c[_0x47d7cb(0xd7)]-0x1;_0x179a32>=0x0;_0x179a32--)if(_0x5efc41=_0x1dec8c[_0x179a32])_0x5ca783=(_0x2fb656<0x3?_0x5efc41(_0x5ca783):_0x2fb656>0x3?_0x5efc41(_0x54321f,_0x3f1592,_0x5ca783):_0x5efc41(_0x54321f,_0x3f1592))||_0x5ca783;}return _0x2fb656>0x3&&_0x5ca783&&Object[_0x47d7cb(0xd9)](_0x54321f,_0x3f1592,_0x5ca783),_0x5ca783;},__metadata=this&&this['__metadata']||function(_0x1f23b5,_0x1ff60c){const _0x13d5ff=_0x2714;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x13d5ff(0xf9))return Reflect[_0x13d5ff(0xfa)](_0x1f23b5,_0x1ff60c);},__param=this&&this['__param']||function(_0x3186e4,_0x2bdc42){return function(_0x5d9d0f,_0x44d912){_0x2bdc42(_0x5d9d0f,_0x44d912,_0x3186e4);};};Object[_0x4b94d4(0xd9)](exports,'__esModule',{'value':!![]}),exports[_0x4b94d4(0xf6)]=void 0x0;function _0x2714(_0xd26e61,_0x1337be){const _0x42204f=_0x4220();return _0x2714=function(_0x271462,_0x3b747a){_0x271462=_0x271462-0xd7;let _0x527a0f=_0x42204f[_0x271462];return _0x527a0f;},_0x2714(_0xd26e61,_0x1337be);}const globalConfig_service_1=require('./../globalConfig/globalConfig.service'),common_1=require('@nestjs/common'),schedule_1=require(_0x4b94d4(0xf1)),userBalance_entity_1=require('../userBalance/userBalance.entity'),typeorm_1=require(_0x4b94d4(0xfb)),typeorm_2=require(_0x4b94d4(0xe5));let TaskService=class TaskService{constructor(_0x553eb4,_0x20495f){const _0x296b6b=_0x4b94d4;this[_0x296b6b(0xf3)]=_0x553eb4,this[_0x296b6b(0xf8)]=_0x20495f;}[_0x4b94d4(0x100)](){const _0x5f2479=_0x4b94d4;common_1[_0x5f2479(0xeb)][_0x5f2479(0xf7)]('Automatically\x20refresh\x20WeChat\x20access\x20every\x20hour\x20Token',_0x5f2479(0xf6)),this[_0x5f2479(0xf8)]['getWechatAccessToken']();}['checkauth'](){const _0x498915=_0x4b94d4;common_1['Logger'][_0x498915(0xf7)](_0x498915(0xe0),_0x498915(0xf6)),this['globalConfigService']['nineAiCheckAuth']();}async[_0x4b94d4(0xdc)](){const _0x169faf=_0x4b94d4,_0x2066c1=await this['userBalanceEntity'][_0x169faf(0xe9)]({'where':{'expirationTime':(0x0,typeorm_2[_0x169faf(0xe8)])(new Date())}});if(!_0x2066c1||!_0x2066c1[_0x169faf(0xd7)])return;_0x2066c1[_0x169faf(0xde)](_0x41337b=>{const _0x2f52c6=_0x169faf;this[_0x2f52c6(0xf3)][_0x2f52c6(0xed)]({'id':_0x41337b['id']},{'expirationTime':null,'packageId':0x0,'memberModel3Count':0x0,'memberModel4Count':0x0,'memberDrawMjCount':0x0})[_0x2f52c6(0xdb)](_0x4af4dd=>{const _0x56885c=_0x2f52c6;common_1[_0x56885c(0xeb)]['debug'](_0x41337b['id']+_0x56885c(0x102),_0x56885c(0xf6));});});}};__decorate([(0x0,schedule_1[_0x4b94d4(0xe4)])(schedule_1['CronExpression']['EVERY_HOUR']),__metadata(_0x4b94d4(0xe6),Function),__metadata(_0x4b94d4(0xf4),[]),__metadata('design:returntype',void 0x0)],TaskService[_0x4b94d4(0x101)],_0x4b94d4(0x100),null),__decorate([(0x0,schedule_1[_0x4b94d4(0xe4)])(schedule_1[_0x4b94d4(0xf2)]['EVERY_HOUR']),__metadata(_0x4b94d4(0xe6),Function),__metadata(_0x4b94d4(0xf4),[]),__metadata(_0x4b94d4(0xef),void 0x0)],TaskService[_0x4b94d4(0x101)],_0x4b94d4(0xfd),null),__decorate([(0x0,schedule_1['Cron'])(schedule_1[_0x4b94d4(0xf2)]['EVERY_5_MINUTES']),__metadata(_0x4b94d4(0xe6),Function),__metadata(_0x4b94d4(0xf4),[]),__metadata(_0x4b94d4(0xef),Promise)],TaskService[_0x4b94d4(0x101)],_0x4b94d4(0xdc),null),TaskService=__decorate([(0x0,common_1[_0x4b94d4(0xfe)])(),__param(0x0,(0x0,typeorm_1[_0x4b94d4(0xda)])(userBalance_entity_1['UserBalanceEntity'])),__metadata(_0x4b94d4(0xf4),[typeorm_2[_0x4b94d4(0xfc)],globalConfig_service_1[_0x4b94d4(0xd8)]])],TaskService),exports['TaskService']=TaskService;