"use strict";
function _0x490d(_0x5d72a3, _0x35dcd9) {
  const _0x10ed7d = _0x10ed();
  return (
    (_0x490d = function (_0x490daa, _0x430cc0) {
      _0x490daa = _0x490daa - 0x88;
      let _0x49734c = _0x10ed7d[_0x490daa];
      return _0x49734c;
    }),
    _0x490d(_0x5d72a3, _0x35dcd9)
  );
}
const _0x825cd0 = _0x490d;
(function (_0x5d6c69, _0x109820) {
  const _0x31f47d = _0x490d,
    _0x34522f = _0x5d6c69();
  while (!![]) {
    try {
      const _0x2ba34f =
        (-parseInt(_0x31f47d(0xb5)) / 0x1) *
          (-parseInt(_0x31f47d(0x99)) / 0x2) +
        (parseInt(_0x31f47d(0xb1)) / 0x3) * (parseInt(_0x31f47d(0xaf)) / 0x4) +
        (-parseInt(_0x31f47d(0xc3)) / 0x5) * (parseInt(_0x31f47d(0xa5)) / 0x6) +
        (-parseInt(_0x31f47d(0x95)) / 0x7) *
          (-parseInt(_0x31f47d(0xbc)) / 0x8) +
        (parseInt(_0x31f47d(0xa6)) / 0x9) * (parseInt(_0x31f47d(0xb8)) / 0xa) +
        -parseInt(_0x31f47d(0xb9)) / 0xb +
        (parseInt(_0x31f47d(0xb4)) / 0xc) * (parseInt(_0x31f47d(0x8b)) / 0xd);
      if (_0x2ba34f === _0x109820) break;
      else _0x34522f["push"](_0x34522f["shift"]());
    } catch (_0x5f3884) {
      _0x34522f["push"](_0x34522f["shift"]());
    }
  }
})(_0x10ed, 0x79a56);
function _0x10ed() {
  const _0x45ae67 = [
    "jwt",
    "handleRequest",
    "194tagRVI",
    "function",
    "extractToken",
    "object",
    "globalConfigService",
    "path",
    "get",
    "metadata",
    "redisCacheService",
    "JwtAuthGuard",
    "AuthGuard",
    "5oSf6LCi5L2/55SoTmluZUFp44CB5b2T5YmN5Li655uX54mI56iL5bqP44CB5q2j54mI6K+35re75Yqg5L2c6ICFVljvvJogSl9sb25neWFu44CB5oiWcXE6IDkyNzg5ODYzOeOAgeS6pOa1gee+pOivt+a3u+WKoDc1NzI5NjE4OeOAgeivt+aUr+aMgeato+eJiOOAgeivt+WLv+S4iuW9k+WPl+mql++8gQ==",
    "18TCIgVW",
    "2872935xGzSAC",
    "HttpStatus",
    "UnauthorizedException",
    "length",
    "jsonwebtoken",
    "split",
    "RedisCacheService",
    "../../modules/redisCache/redisCache.service",
    "getOwnPropertyDescriptor",
    "12HNegDL",
    "switchToHttp",
    "162462wpVmJf",
    "validateToken",
    "Injectable",
    "12YijwRB",
    "803oQIbug",
    "headers",
    "getNineAiToken",
    "30LTtMJL",
    "8401789sIoJrf",
    "GlobalConfigService",
    "atob",
    "872ffCudq",
    "__esModule",
    "JWT_SECRET",
    "ModuleRef",
    "UNAUTHORIZED",
    "design:paramtypes",
    "verify",
    "373370lmQlPe",
    "checkTokenAuth",
    "@nestjs/core",
    "env",
    "getInfo",
    "2449967PAlWWY",
    "getRequest",
    "__decorate",
    "defineProperty",
    "../utils",
    "user",
    "Bearer",
    "../../modules/globalConfig/globalConfig.service",
    "HttpException",
    "authorization",
    "6398IXkByS",
    "亲爱的用户,请登录后继续操作,我们正在等您的到来！"
  ];
  _0x10ed = function () {
    return _0x45ae67;
  };
  return _0x10ed();
}
var __decorate =
    (this && this[_0x825cd0(0x8d)]) ||
    function (_0x4478c6, _0x4bb70b, _0xb047f2, _0x33b377) {
      const _0x59af9a = _0x825cd0;
      var _0xa67b9d = arguments[_0x59af9a(0xa9)],
        _0x252940 =
          _0xa67b9d < 0x3
            ? _0x4bb70b
            : _0x33b377 === null
            ? (_0x33b377 = Object[_0x59af9a(0xae)](_0x4bb70b, _0xb047f2))
            : _0x33b377,
        _0x46e810;
      if (
        typeof Reflect === _0x59af9a(0x9c) &&
        typeof Reflect["decorate"] === _0x59af9a(0x9a)
      )
        _0x252940 = Reflect["decorate"](
          _0x4478c6,
          _0x4bb70b,
          _0xb047f2,
          _0x33b377
        );
      else {
        for (
          var _0x5ea9a4 = _0x4478c6[_0x59af9a(0xa9)] - 0x1;
          _0x5ea9a4 >= 0x0;
          _0x5ea9a4--
        )
          if ((_0x46e810 = _0x4478c6[_0x5ea9a4]))
            _0x252940 =
              (_0xa67b9d < 0x3
                ? _0x46e810(_0x252940)
                : _0xa67b9d > 0x3
                ? _0x46e810(_0x4bb70b, _0xb047f2, _0x252940)
                : _0x46e810(_0x4bb70b, _0xb047f2)) || _0x252940;
      }
      return (
        _0xa67b9d > 0x3 &&
          _0x252940 &&
          Object[_0x59af9a(0x8e)](_0x4bb70b, _0xb047f2, _0x252940),
        _0x252940
      );
    },
  __metadata =
    (this && this["__metadata"]) ||
    function (_0x2ae400, _0x6163cb) {
      const _0x8a8e3b = _0x825cd0;
      if (
        typeof Reflect === "object" &&
        typeof Reflect[_0x8a8e3b(0xa0)] === _0x8a8e3b(0x9a)
      )
        return Reflect[_0x8a8e3b(0xa0)](_0x2ae400, _0x6163cb);
    };
Object["defineProperty"](exports, _0x825cd0(0xbd), { value: !![] }),
  (exports[_0x825cd0(0xa2)] = void 0x0);
const redisCache_service_1 = require(_0x825cd0(0xad)),
  common_1 = require("@nestjs/common"),
  passport_1 = require("@nestjs/passport"),
  jwt = require(_0x825cd0(0xaa)),
  core_1 = require(_0x825cd0(0x88)),
  globalConfig_service_1 = require(_0x825cd0(0x92)),
  utils_1 = require(_0x825cd0(0x8f));
let JwtAuthGuard = class JwtAuthGuard extends (0x0,
passport_1[_0x825cd0(0xa3)])(_0x825cd0(0x97)) {
  constructor(_0xddb5ab, _0x34213d, _0x47606c) {
    const _0x5510a1 = _0x825cd0;
    super(),
      (this[_0x5510a1(0xa1)] = _0xddb5ab),
      (this["moduleRef"] = _0x34213d),
      (this[_0x5510a1(0x9d)] = _0x47606c);
  }
  async ["canActivate"](_0x4e2e11) {
    const _0x5a3fd4 = _0x825cd0;
    !this[_0x5a3fd4(0xa1)] &&
      (this["redisCacheService"] = this["moduleRef"][_0x5a3fd4(0x9f)](
        redisCache_service_1["RedisCacheService"],
        { strict: ![] }
      ));
    const _0x221fc8 = _0x4e2e11[_0x5a3fd4(0xb0)]()[_0x5a3fd4(0x8c)](),
      _0x2add67 = this[_0x5a3fd4(0x9b)](_0x221fc8);
    _0x221fc8[_0x5a3fd4(0x90)] = this[_0x5a3fd4(0xb2)](_0x2add67);
    const _0x660807 = this[_0x5a3fd4(0x9d)][_0x5a3fd4(0xb7)]();
    if (_0x660807 && !_0x221fc8[_0x5a3fd4(0x9e)]["includes"](_0x5a3fd4(0x8a)))
      throw new common_1["HttpException"](
        (0x0, utils_1[_0x5a3fd4(0xbb)])(_0x5a3fd4(0xa4)),
        common_1["HttpStatus"]["BAD_REQUEST"]
      );
    return (
      await this["redisCacheService"][_0x5a3fd4(0xc4)](
        _0x2add67,
        _0x221fc8[_0x5a3fd4(0x90)]["id"],
        _0x221fc8[_0x5a3fd4(0x90)]["role"]
      ),
      !![]
    );
  }
  [_0x825cd0(0x9b)](_0x36742a) {
    const _0x368b56 = _0x825cd0;
    if (!_0x36742a["headers"][_0x368b56(0x94)]) return null;
    const _0x421fec =
      _0x36742a[_0x368b56(0xb6)][_0x368b56(0x94)][_0x368b56(0xab)](" ");
    if (
      _0x421fec[_0x368b56(0xa9)] !== 0x2 ||
      _0x421fec[0x0] !== _0x368b56(0x91)
    )
      return null;
    return _0x421fec[0x1];
  }
  [_0x825cd0(0xb2)](_0x1552a6) {
    const _0x5ea8c7 = _0x825cd0;
    try {
      return jwt[_0x5ea8c7(0xc2)](
        _0x1552a6,
        process[_0x5ea8c7(0x89)][_0x5ea8c7(0xbe)]
      );
    } catch (_0x1dfd40) {
      throw new common_1[_0x5ea8c7(0x93)](
        _0x5ea8c7(0x96),
        common_1[_0x5ea8c7(0xa7)][_0x5ea8c7(0xc0)]
      );
    }
  }
  [_0x825cd0(0x98)](_0x3d7419, _0x5dcc7f, _0x724c04) {
    const _0x118efb = '_0x825cd0';
    if (_0x3d7419 || !_0x5dcc7f) {
      console["log"]("err: ", _0x3d7419);
      throw _0x3d7419 || new common_1[_0x118efb(0xa8)]();
    }
    return _0x5dcc7f;
  }
};
(JwtAuthGuard = __decorate(
  [
    (0x0, common_1[_0x825cd0(0xb3)])(),
    __metadata(_0x825cd0(0xc1), [
      redisCache_service_1[_0x825cd0(0xac)],
      core_1[_0x825cd0(0xbf)],
      globalConfig_service_1[_0x825cd0(0xba)]
    ])
  ],
  JwtAuthGuard
)),
  (exports[_0x825cd0(0xa2)] = JwtAuthGuard);
